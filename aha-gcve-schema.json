{
  "$id": "https://raw.githubusercontent.com/hugesuccessllc/gcve/refs/heads/main/aha-gcve-schema.json",
  "title": "AHA! GCVE Record",
  "description": "AHA! GCVE records derived from regular CVE JSON.",
  "type": "object",
  "required": [
    "gcveId",
    "gcveProviderId",
    "datePublic",
    "description",
    "cveId"
  ],
  "properties": {
    "gcveId": {
      "type": "string",
      "pattern": "^GCVE-1337-\\d+-\\d+$",
      "description": "The GCVE identifier, extracted from a provided reference URL."
    },
    "gcveProviderId": {
      "type": "integer",
      "description": "Numeric provider ID, derived from the first numeric field of the gcveId."
    },
    "datePublic": {
      "type": "string",
      "format": "date",
      "description": "Date the vulnerability details were made public, derived from the CVE record (ISO 8601)."
    },
    "title": {
      "type": ["string", "null"],
      "description": "Optional CVE title."
    },
    "description": {
      "type": "object",
      "required": ["lang", "value"],
      "properties": {
        "lang": {
          "type": "string",
          "description": "Language code of the description."
        },
        "value": {
          "type": "string",
          "description": "The CVE description text."
        }
      }
    },
    "cweIds": {
      "type": ["array", "null"],
      "items": { "type": "string" },
      "description": "Optional array of CWE identifiers."
    },
    "cvss": {
      "type": ["object", "null"],
      "description": "Optional CVSS v3.1 metrics object."
    },
    "ssvc": {
      "type": ["object", "null"],
      "description": "Optional SSVC assessment. Properties of this object are not validated. See the current SSVC and Vulnrichment schemas for reference."
    },
    "credits": {
      "type": ["array", "null"],
      "description": "Optional array of credit entries (people or organizations)."
    },
    "references": {
      "type": ["array", "null"],
      "description": "Optional array of reference objects (including GCVE URL)."
    },
    "affected": {
      "type": ["array", "null"],
      "description": "Optional array describing affected products."
    },
    "cveId": {
      "type": "string",
      "pattern": "^CVE-[0-9]{4}-[0-9]{4,19}$",
      "description": "The original CVE identifier. (see https://github.com/CVEProject/cve-schema/blob/main/schema/CVE_Record_Format.json)"
    }
  },
  "additionalProperties": false
}
